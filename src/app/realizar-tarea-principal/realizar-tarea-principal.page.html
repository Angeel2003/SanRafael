<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button 
        defaultHref="/agenda" 
        aria-label="Volver a la agenda">
      </ion-back-button>
    </ion-buttons>
    <ion-row class="header-row">
      <ion-col size="auto">
        <ion-title class="title">{{ tarea.nombre | uppercase }}</ion-title>
      </ion-col>
      <ion-col size="auto" class="image-col">
        <img 
          [src]="tarea.previewUrl" 
          alt="Pictograma de previsualización de tarea" 
          class="tarea-preview-image" 
        />
      </ion-col>
    </ion-row>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div>
    <ion-grid>
      <ion-row>
        <ion-col size="12" class="image-container">
          <img [src]="tarea.previewUrl" alt="Previsualización {{tarea.nombre}}" class="task-image" />
        </ion-col>
      </ion-row>

      <!-- Condición para mostrar el video solo si el tipo de tarea es 'tarea-por-pasos' -->
      <ion-row *ngIf="tipoTarea === 'tarea-por-pasos'">
        <ion-col size="12" class="video-container">
          <div class="video-container">
            <video 
              [src]="tarea.videoCompletoUrl" 
              class="task-video" 
              #videoPlayer 
              (click)="togglePlay(videoPlayer)">
            </video>
            <button 
              class="play-button" 
              [class.hidden]="!showPlayButton" 
              (click)="togglePlay(videoPlayer)">
              <ion-icon name="play-outline"></ion-icon>
            </button>
          </div>
        </ion-col>
      </ion-row>

      <ion-row *ngIf="tipoTarea === 'tarea-comanda'" >
        <ion-col  size="3" *ngFor="let aula of aulas" class="aula-button-col">
          <ion-button class="aula-button" (click)="entrarAula(aula)">
            {{ aula.nombre }}
          </ion-button>
          <ion-icon *ngIf="nivelAccesibilidad != 'Texto' && nivelAccesibilidad != 'Audio' && aulaGuardada(aula.nombre)" name="checkmark-outline" class="check-overlay"></ion-icon>
        </ion-col>
      </ion-row>

      <ion-row *ngIf="tipoTarea === 'tarea-material'">
        <ion-col>
          <ion-label class="label-aula">MATERIAL&nbsp; PARA&nbsp; EL&nbsp; AULA:&nbsp;&nbsp;{{ tarea.aula | uppercase}}</ion-label>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>

  <div class="pagination-buttons">
    <ion-button *ngIf="tipoTarea === 'tarea-por-pasos'" class="custom-button" (click)="realizarTareaPasos(tarea, videoPlayer.nativeElement)">
      <ion-icon name="arrow-forward-outline"></ion-icon>
    </ion-button>
    <ion-button *ngIf="tipoTarea === 'tarea-material'" class="custom-button" (click)="realizarTarea(tarea)">
      <ion-icon name="arrow-forward-outline"></ion-icon>
    </ion-button>
    <ion-button 
      *ngIf="tipoTarea != 'tarea-comanda'"
      (click)="tareaTerminada(tarea, '/agenda')"
      class="finish-task-button">
      <div class="button-content">
        <img *ngIf="nivelAccesibilidad != 'Texto' && nivelAccesibilidad != 'Audio'" [src]="imageOk" alt="Imagen de bien" class="task-image"/>
        <span>TERMINAR TAREA</span>
      </div>
    </ion-button>
  </div>
</ion-content>
